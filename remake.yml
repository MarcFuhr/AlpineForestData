packages:
  - rmarkdown
  - knitr
  - maps
  - parallel
  - MASS
  - mvoutlier
  - quantreg
  - splines
  - bibtex

sources:
  - R

targets:
  all:
    depends:
      - manuscript
      - data
      - figures

  manuscript:
    depends:
      - ms/metadata.html
      - ms/metadata.docx


  figures:
    depends:
      - figures/allo_error.pdf
      - figures/growth_error.pdf


  data:
    depends:
      - output/list_data.rds
      - data_c
      - data_m
      - data_p
      - df_growth
      - output/metadata_data_c.csv
      - output/metadata_data_m.csv
      - output/metadata_data_p.csv
      - output/table_plot.csv
      - output/table_plot2.csv
      - output/table_plot3.csv
      - output/data_wrong_allo2.csv
      - output/data_sp_code.csv

  ms/metadata.md:
    knitr:
      chdir: true
      auto_figure_prefix: true
    packages:
      - whisker
      - knitcitations
    depends:
      - data
      - ms/refs.bib
      - R/ms.R


  ms/metadata.html:
    command: render_html("ms/metadata.md")
    quiet: true
    depends:
      - ms/metadata.Rmd

  ms/metadata.docx:
    command: render_doc("ms/metadata.md")
    quiet: true
    depends:
      - ms/metadata.Rmd

  df_growth:
    command: get_data_growth()
    depends: output/df_growth.rds

  output/df_growth.rds:
    command: save_data_growth(data_m)

  output/list_data.rds:
    command: read_all_data_and_clean()

  data_c:
    command:  get_data_c()
    depends: output/data_c.rds

  output/data_c.rds:
    command:  save_data_c()
    depends: output/list_data.rds

  data_m:
    command:  get_data_m()
    depends: output/data_m.rds

  output/data_m.rds:
    command:  save_data_m()
    depends: output/list_data.rds

  data_p:
    command:  get_data_p()
    depends: output/data_p.rds

  output/data_p.rds:
    command:  save_data_p()
    depends: output/list_data.rds

  output/metadata_data_c.csv:
    command: generate_metadata_c(data_c)

  output/metadata_data_m.csv:
    command: generate_metadata_m(data_m)

  output/metadata_data_p.csv:
    command: generate_metadata_p(data_p)

  output/tree_wrong_growth.csv:
    command: save_growth_error(df_growth)

  output/tree_wrong_allo.csv:
    command: save_allo_error(data_m)

  figures/allo_error.pdf:
    command: plot_allo_error(data_m)
    plot: true

  figures/growth_error.pdf:
    command: plot_growth_error(df_growth)
    plot: true

  output/table_plot.csv:
    command: table_plot(data_p)

  output/table_plot2.csv:
    command: table_stand(data_p, data_m, data_c)

  output/table_plot3.csv:
    command: table_stand_b(data_p, data_m, data_c)

  output/data_wrong_allo2.csv:
    command: save_allo_error(data_m)

  output/data_sp_code.csv:
    command: data_sp(data_c)

